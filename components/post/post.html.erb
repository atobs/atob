<% set_default("title", "Title") %>
<% set_default("text", "post text") %>
<% set_default("collapsed", true) %>
<% set_default("maximized", false) %>
<% set_default("post_id", 0) %>
<% set_default("created_at", new Date()) %>
<% set_default("replies", []) %>
<% set_default("tripcode", "") %>
<% set_default("author", "anon") %>

<div class="post <%= maximized ? "maximize" : "" %>" data-post-id="<%= post_id %>" style="display: none">
  <div class="title clearfix">
    <a href="/p/<%= post_id %>" >
      <h4><b><%- title %></b> </h4>
    </a>

    <div class="mbm">
      <div class="tripcode" title="<%- author || "anon" %>" data-tripcode="<%= tripcode %>"> </div>

      <div class="post_id" style="margin-top: -10px; display: inline-block">
        <a target="_blank" href="#" title="<%= created_at %>"><small>#<%= post_id %></small></a>
      </div>

      <div class="created" style="margin-top: -10px; display: inline-block">
        <small>posted
          <span class="timeago" title="<%= created_at.toISOString() %>"> </span>
        </small>
      </div>

      <small><a title="maximize" class="mll rfloat restore icon-restore"></a></small>
      <small class="last_reply rfloat">
        last reply was
        <% if (replies.length) { %>
          <% var last_reply_date = new Date(replies[replies.length - 1].created_at) %>
          <% var offset = last_reply_date.getTimezoneOffset() %>
          <% var adjusted_date = new Date((last_reply_date.getTime()) - (offset * 60 * 1000)); %>
            <span
              class="timeago"
              title="<%= adjusted_date.toISOString() %>" />
        <% } else { %>
            <span
              class="timeago"
              title="">never. be first! </span>
        <% } %>
      </small>

      <div class="counts" style="margin-top: -10px; display: inline-block; font-weight: bold"> </div>
    </div>

  </div>

  <div class="op text col-md-12 mbl" style=>
    <%- text %>
  </div>

  <div id="post<%= post_id %>" class="<%= collapsed ? "collapse" : "" %> cpost">

    <div class="replies clearfix mtl col-md-12 <%= replies.length > 6 ? "many" : "" %>">
      <% _.each(replies, function(r) { %>
        <div class="ptl pbl" id="reply<%= r.id %>">
          <div class="tripcode" title="<%- r.author %>" data-tripcode="<%= r.tripcode %>"></div>
          <a target="_blank" href="#" title="<%= new Date(r.created_at).toLocaleString() %>">
            <small>#<%= r.id %></small></a>
          <b><%- r.title %></b>
          <small class="text"><%- r.text %></small>
        </div>

      <% }); %>
    </div>

  </div>

  <div class="clearfix">
    <a title="maximize" class="mtl mll rfloat restore">[expand]</a>

    <a href="#" class="mtl see_replies lfloat" data-toggle="collapse" data-target="#post<%= post_id %>">
        [
        <span class="reply_count"><%= replies.length %></span> replies
        ]

    </a>

  </div>

  <div class="mtl clearfix">
    <form class="reply">
      <div class="mtl clearfix mbl">
        <textarea type="text" class="form-control" placeholder="reply"> </textarea>
      </div>
    </form>
  </div>



</div>
